(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6903],{5821:function(t,a,e){Promise.resolve().then(e.bind(e,588))},588:function(t,a,e){"use strict";e.r(a),e.d(a,{default:function(){return G}});var r=e(7437),s=e(2265),d=e(1971),l=e(8745),n=e(9376),i=e(8946),o=e.n(i),c=e(2442);e(3522);var u=e(784),m=e(878);e(320),e(9848);var p=t=>{let{index:a,setIndex:e,slides:s}=t;return(0,r.jsx)(c.ZP,{index:a,slides:s,open:a>=0,close:()=>e(-1),plugins:[u.Z,m.Z]})},h=e(3011),g=e(6885),x=e(4061),v=e(4010);let j=(0,h.U)((0,g.mW)(t=>({dtProductImages:{last_page:0,current_page:0,data:[]},setProductImages:async a=>{let{page:e=1,limit:r=10,search:s,sortby:d,order:l,product_id:n}=a;try{let a=await v.Z.getState().setToken(),i=await (0,x.Sj)({method:"get",url:"/productImages",headers:{Authorization:"Bearer ".concat(a)},params:{limit:r,page:e,search:s,sortby:d,order:l,product_id:n}});return t(t=>({...t,dtProductImages:i.data.data})),{status:"berhasil",data:i.data}}catch(t){var i;return{status:"error",error:null===(i=t.response)||void 0===i?void 0:i.data}}},setShowProductImages:async a=>{try{let e=await v.Z.getState().setToken(),r=await (0,x.Sj)({method:"get",url:"/productImages/".concat(a),headers:{Authorization:"Bearer ".concat(e)}});return t(t=>({...t,dtProductImages:r.data.data})),{status:"berhasil",data:r.data}}catch(t){var e;return{status:"error",error:null===(e=t.response)||void 0===e?void 0:e.data}}},addData:async a=>{try{let e=await v.Z.getState().setToken(),r=await (0,x.Sj)({method:"post",url:"/productImages",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"multipart/form-data"},data:a});return console.log({res:r}),t(t=>({dtProductImages:{last_page:t.dtProductImages.last_page,current_page:t.dtProductImages.current_page,data:r.data.data}})),{status:"berhasil tambah",data:r.data}}catch(t){return{status:"error",data:t.response.data}}},removeData:async a=>{try{let e=await v.Z.getState().setToken(),r=await (0,x.Sj)({method:"delete",url:"/productImages/".concat(a),headers:{Authorization:"Bearer ".concat(e)}});return t(t=>({dtProductImages:{last_page:t.dtProductImages.last_page,current_page:t.dtProductImages.current_page,data:t.dtProductImages.data.filter(t=>t.id!==a)}})),{status:"berhasil hapus",data:r.data}}catch(t){return{status:"error",data:t.response.data}}},updateData:async(a,e)=>{try{let r=await v.Z.getState().setToken(),s=await (0,x.Sj)({method:"POST",url:"/productImages/".concat(a,"?_method=PUT"),headers:{Authorization:"Bearer ".concat(r),"Content-Type":"multipart/form-data"},data:e});return t(t=>({dtProductImages:{last_page:t.dtProductImages.last_page,current_page:t.dtProductImages.current_page,data:t.dtProductImages.data.map(t=>t.id===a?{...t,...s.data.data}:t)}})),{status:"berhasil update",data:s.data}}catch(t){return{status:"error",data:t.response.data}}}}))),f=(t,a)=>"string"==typeof a?a:"object"==typeof a&&"path"in a?t[a.path]:"";var _=t=>{let{data:a,picture:e,title:r,description:s,width:d,height:l}=t;return null==a?void 0:a.map(t=>({src:"".concat(x._n,"/").concat(t[e]),title:f(t,r),description:f(t,s),width:d||3840,height:l||5760}))},w=t=>{let{setDelete:a,setEdit:e,product_id:i}=t,{setProductImages:c,dtProductImages:u}=j(),[m,h]=(0,s.useState)(1),[g,x]=(0,s.useState)(10),[v,f]=(0,s.useState)(!0),[w,b]=(0,s.useState)(-1),[y,S]=(0,s.useState)(),P=(0,n.useSearchParams)(),k=(null==P?void 0:P.get("sortby"))||"",N=(null==P?void 0:P.get("order"))||"",I=(null==P?void 0:P.get("cari"))||"",Z=o().debounce(t=>{t()},500),T=(0,s.useCallback)(async()=>{x(10),await c({page:m,limit:g,search:I,sortby:k,order:N,product_id:i}),f(!1)},[c,m,g,I,k,N,i]);return(0,s.useEffect)(()=>(Z(T),()=>{Z.cancel()}),[I,k,N,m,g]),(0,s.useEffect)(()=>{S(_({data:null==u?void 0:u.data,picture:"product_img",title:{path:"is_main"},description:{path:""},width:3840,height:5760}))},[null==u?void 0:u.data]),(0,r.jsxs)("div",{className:"flex-1 flex-col max-w-full h-full overflow-auto",children:[(0,r.jsx)(p,{index:w,setIndex:b,slides:y}),v?(0,r.jsx)("span",{className:"loading loading-infinity loading-lg"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"",children:(0,r.jsx)(l.Z,{headTable:["No","Gambar","Utama","Aksi"],tableBodies:["product_img","is_main"],dataTable:null==u?void 0:u.data,page:m,limit:g,setEdit:e,setDelete:a,ubah:!0,hapus:!0,setIndexBox:b})}),(null==u?void 0:u.last_page)>1&&(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(d.Z,{currentPage:null==u?void 0:u.current_page,totalPages:null==u?void 0:u.last_page,setPage:h})})]})]})},b=e(6433),y=e(9064),S=e(543),P=e(2841),k=e(1400),N=t=>{let{register:a,setValue:e,watch:s,halaman:d}=t;return(0,r.jsx)("div",{className:"grid grid-cols-8 gap-2 w-full",children:(0,r.jsx)(k.Z,{watch:s,setValue:e,name:"cari",register:a,placeholder:"Cari data ".concat(d),addClass:"col-span-8"})})},I=e(9501),Z=e(1505),T=e(9762),C=t=>{let{value:a,register:e,required:s,name:d,defaultChecked:l,id:n,errors:i,label:o,onChange:c,checked:u}=t;return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex gap-1 items-start justify-center",children:[(0,r.jsx)("input",{type:"checkbox",value:a,id:n.toString(),name:d,...e(d,{required:s}),className:"form-radio h-4 w-4 text-primary",defaultChecked:l,checked:u,onChange:c}),o&&(0,r.jsx)("label",{htmlFor:n.toString(),children:o})]}),(null==i?void 0:i.type)==="required"&&(0,r.jsx)("p",{className:"text-red-500 font-inter italic text-sm",children:"Tidak boleh kosong"})]})},E=e(7165),A=e.n(E),D=t=>{let{label:a,register:e,required:d,name:l,errors:n,addClass:i,accept:o,setValue:c,fileEdit:u,initialValue:m,watch:p,size:h="md",labelCss:g="text-gray-700"}=t,[v,j]=(0,s.useState)(""),[f,_]=(0,s.useState)([m||""]),w=p(l);(0,s.useEffect)(()=>{w||_([])},[w]);let b=t=>new Promise(a=>{let e="sm"===h?500:"md"===h?1e3:1600;if(t){var r;let s=(null==t?void 0:null===(r=t.type)||void 0===r?void 0:r.split("/"))||[];"image"!==s[0]?a(t):A().imageFileResizer(t,e,e,s[1],100,0,t=>{a(t)},"file")}else a(null)}),y=async t=>{let a=Array.from(t);c(l,(await Promise.all(a.map(b))).map(t=>{var a;let e=new FileReader;return e.readAsDataURL(t),e.onloadend=()=>{_(t=>[...t,e.result])},j(((null==t?void 0:null===(a=t.type)||void 0===a?void 0:a.split("/"))||[])[0]),t}))};return(0,r.jsxs)("div",{className:i,children:[a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("label",{className:"text-sm font-medium tracking-wide ".concat(g),children:a}),d&&(0,r.jsx)("span",{className:"ml-1 text-red-600",children:"*"}),!d&&(0,r.jsx)("span",{className:"text-sm font-medium tracking-wide ".concat(g),children:"(Optional)"})]}),(0,r.jsx)("input",{className:"w-full text-base px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-secondary",id:"fileInput",type:"file",accept:o,multiple:!m,onChange:t=>{let a=t.target.files;a&&y(a)},onClick:()=>{_([])}}),(0,r.jsx)("input",{type:"hidden",id:a,...e(l,{required:d})}),(0,r.jsxs)("div",{className:"flex gap-4 mt-2 flex-wrap",children:[f&&f.map((t,a)=>"image"===v?(0,r.jsx)("img",{className:"rounded-lg w-36",src:t,alt:""},a):(0,r.jsxs)("p",{children:["File: ",t.name]},a)),u&&u.map((t,a)=>(0,r.jsx)("div",{children:(0,r.jsx)("img",{src:"".concat(x._n,"/").concat(t),className:"rounded-lg w-24",alt:""})},a))]}),(null==n?void 0:n.type)==="required"&&(0,r.jsxs)("p",{className:"text-red-500 font-inter italic text-sm",children:[a," tidak boleh kosong"]})]})},B=t=>{let{register:a,errors:e,setValue:s,watch:d,dtEdit:l}=t;return console.log({dtEdit:l}),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"col-span-8 flex gap-1 items-center",children:[(0,r.jsx)("span",{children:"Gambar Utama?"}),(0,r.jsx)(C,{value:null==l?void 0:l.is_main,name:"is_main",register:a,errors:e.is_main,id:"is_main"})]}),(0,r.jsx)(D,{label:"Gambar",name:"product_img",register:a,addClass:"col-span-8",setValue:s,required:!(null==l?void 0:l.product_img),errors:e.product_img,fileEdit:[null==l?void 0:l.product_img],initialValue:(null==l?void 0:l.product_img)||"",watch:d,accept:"image/*"})]})},z=e(7550),F=t=>{let{showModal:a,setShowModal:e,dtEdit:d,halaman:l,product_id:n}=t,{addData:i,updateData:o}=j(),[c,u]=(0,s.useState)(!1),{register:m,handleSubmit:p,setValue:h,control:g,formState:{errors:x},watch:v}=(0,I.cI)(),f=()=>{h("id",""),h("is_main",!1),h("product_img","")};(0,s.useEffect)(()=>{d?(h("id",d.id),h("is_main",d.is_main)):f()},[a,d]);let _=async t=>{t.product_id=n,t.is_main=t.is_main?1:0,(0,z.Z)({row:t,dtEdit:d,setIsLoading:u,setShowModal:e,addData:i,updateData:o,resetForm:f,toastShow:S.Z})};return(0,r.jsx)(T.Z,{title:"Form ".concat(l),showModal:a,setShowModal:e,width:"md:w-[50rem] lg:w-[65rem]",children:(0,r.jsxs)("form",{onSubmit:p(_),children:[(0,r.jsx)(Z.Z,{name:"id",register:m,type:"hidden"}),(0,r.jsx)("div",{className:"grid grid-cols-8 gap-2 mb-4",children:(0,r.jsx)(B,{register:m,errors:x,dtEdit:d,control:g,watch:v,setValue:h,showModal:a})}),(0,r.jsx)("div",{children:c?(0,r.jsx)("span",{className:"loading loading-spinner loading-lg"}):(0,r.jsx)("button",{className:"btn btn-primary",onClick:p(_),type:"submit",children:"Simpan"})})]})})},U=e(7648),M=e(8278),G=()=>{let t=(0,n.useSearchParams)(),a=(null==t?void 0:t.get("product_id"))||"",e="Gambar Produk",{setWelcome:d}=(0,P.I)(),{removeData:l}=j(),{setShowProducts:i,showProduct:o}=(0,M.Z)(),[c,u]=(0,s.useState)(!1),[m,p]=(0,s.useState)(!1),[h,g]=(0,s.useState)(),[x,v]=(0,s.useState)();(0,s.useEffect)(()=>{i(a)},[a,i]),console.log({showProduct:o}),(0,s.useEffect)(()=>(d("Halaman ".concat(e," - ").concat(null==o?void 0:o.product_nm)),()=>{}),[d,null==o?void 0:o.product_nm]);let f=async t=>{let{id:a,isDelete:e}=t;if(g(a),e){let{data:t}=await l(h);(0,S.Z)({event:t}),p(!1)}else p(!0)},{register:_,setValue:k,watch:Z,control:T}=(0,I.cI)();return(0,r.jsxs)("div",{className:"flex flex-col h-full w-full",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(y.x7,{}),(0,r.jsx)(F,{dtEdit:null!=x?x:null,showModal:c,setShowModal:u,halaman:e,product_id:a}),(0,r.jsx)(b.Z,{showDel:m,setShowDel:p,setDelete:f}),(0,r.jsx)(U.default,{className:"text-neutral underline hover:no-underline",href:"/products/lists",children:"Kembali"}),(0,r.jsxs)("div",{className:"mb-4 flex justify-between",children:[(0,r.jsxs)("p",{children:["Silahkan Mengolah Gambar Produk ",null==o?void 0:o.product_nm]}),(0,r.jsx)("button",{className:"btn btn-primary",onClick:()=>{u(!0),v(null)},children:"Tambah Data"})]})]}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)(N,{halaman:e,register:_,setValue:k,watch:Z,control:T})}),(0,r.jsx)(s.Suspense,{children:(0,r.jsx)(w,{setDelete:f,setEdit:t=>{u(!0),v(t)},product_id:a})})]})}},8278:function(t,a,e){"use strict";var r=e(3011),s=e(6885),d=e(4061),l=e(4010);let n=(0,r.U)((0,s.mW)(t=>({dtProducts:{last_page:0,current_page:0,data:[]},setProducts:async a=>{let{page:e=1,limit:r=10,search:s,sortby:n,order:i}=a;try{let a=await l.Z.getState().setToken(),o=await (0,d.Sj)({method:"get",url:"/products",headers:{Authorization:"Bearer ".concat(a)},params:{limit:r,page:e,search:s,sortby:n,order:i}});return t(t=>({...t,dtProducts:o.data.data})),console.log({response:o}),{status:"berhasil",data:o.data}}catch(t){var o;return{status:"error",error:null===(o=t.response)||void 0===o?void 0:o.data}}},setShowProducts:async a=>{try{let e=await l.Z.getState().setToken(),r=await (0,d.Sj)({method:"get",url:"/products/".concat(a),headers:{Authorization:"Bearer ".concat(e)}});return t(t=>({...t,showProduct:r.data.data})),{status:"berhasil",data:r.data}}catch(t){var e;return{status:"error",error:null===(e=t.response)||void 0===e?void 0:e.data}}},addData:async a=>{try{let e=await l.Z.getState().setToken(),r=await (0,d.Sj)({method:"post",url:"/products",headers:{Authorization:"Bearer ".concat(e)},data:a});return t(t=>({dtProducts:{last_page:t.dtProducts.last_page,current_page:t.dtProducts.current_page,data:[r.data.data,...t.dtProducts.data]}})),{status:"berhasil tambah",data:r.data}}catch(t){return{status:"error",data:t.response.data}}},removeData:async a=>{try{let e=await l.Z.getState().setToken(),r=await (0,d.Sj)({method:"delete",url:"/products/".concat(a),headers:{Authorization:"Bearer ".concat(e)}});return t(t=>({dtProducts:{last_page:t.dtProducts.last_page,current_page:t.dtProducts.current_page,data:t.dtProducts.data.filter(t=>t.id!==a)}})),{status:"berhasil hapus",data:r.data}}catch(t){return{status:"error",data:t.response.data}}},updateData:async(a,e)=>{try{let r=await l.Z.getState().setToken(),s=await (0,d.Sj)({method:"PUT",url:"/products/".concat(a),headers:{Authorization:"Bearer ".concat(r)},data:e});return t(t=>({dtProducts:{last_page:t.dtProducts.last_page,current_page:t.dtProducts.current_page,data:t.dtProducts.data.map(t=>t.id===a?{...t,...s.data.data}:t)}})),{status:"berhasil update",data:s.data}}catch(t){return{status:"error",data:t.response.data}}}})));a.Z=n}},function(t){t.O(0,[1347,1779,1866,6990,310,8295,9501,9099,8848,7648,5074,9264,2971,2117,1744],function(){return t(t.s=5821)}),_N_E=t.O()}]);